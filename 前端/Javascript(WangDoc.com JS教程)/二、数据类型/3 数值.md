# 数值

## 1. 概述

### 1.1 整数和浮点数

JS中所有数字都以64位浮点数存储，1 === 1.0

某些运算只有整数才能完成，此时 JavaScript 会自动把64位浮点数，转成32位整数，然后再进行运算

```javascript
0.1 + 0.2 === 0.3
// false

0.3 / 0.1
// 2.9999999999999996

(0.3 - 0.2) === (0.2 - 0.1)
// false
```

> [!Tip]
>
> 参见《运算符》一章的“位运算”部分。

### 1.2 数值精度

根据国际标准 IEEE 754，JavaScript 浮点数的64个二进制位，从最左边开始，是这样组成的

- 第1位：符号位，`0`表示正数，`1`表示负数
- 第2位到第12位（共11位）：指数部分
- 第13位到第64位（共52位）：小数部分（即有效数字）

精度最多只能到53个二进制位，这意味着，绝对值小于2的53次方的整数，即 -$2^{53}$ 到$2^{53}$​，都可以精确表示

由于2的53次方是一个16位的十进制数值，所以简单的法则就是，JavaScript 对15位的十进制数都可以精确处理

### 1.3 数值范围

JS能表示的数值范围为$2^{1024}$到$2^{-1023}$之间（开区间）

如果一个数大于等于2的1024次方，那么就会发生“正向溢出”，即 JavaScript 无法表示这么大的数，这时就会返回`Infinity`

```javascript
Math.pow(2, 1024) // Infinity
```

如果一个数小于等于2的-1075次方（指数部分最小值-1023，再加上小数部分的52位），那么就会发生为“负向溢出”，即 JavaScript 无法表示这么小的数，这时会直接返回0

```javascript
Math.pow(2, -1075) // 0
```

`Number`对象的`MAX_VALUE`和`MIN_VALUE`属性可以之直接返回最大值和最小值

------

## 2. 数值的表示方法

+ 十进制

+ 十六进制

  ```javascript
  oxFF
  ```

+ 科学计数法

  ```javascript
  123e3 // 123000
  123e-3 // 0.123
  -3.1E+12
  .1e-23
  ```

  以下两种情况JavaScript 会自动将数值转为科学计数法表示

  1. 小数点前的数字多于21位

     ```javascript
     1234567890123456789012
     // 1.2345678901234568e+21
     
     123456789012345678901
     // 123456789012345680000
     ```

  2. 小数点后的零多于5个

     ```javascript
     // 小数点后紧跟5个以上的零，
     // 就自动转为科学计数法
     0.0000003 // 3e-7
     
     // 否则，就保持原来的字面形式
     0.000003 // 0.000003
     ```

------

## 3. 数值的进制

+ 十进制
+ 八进制：
  1. 前缀`0o`或`00`
  2. 有前导`0`，且只用`0-7`（此方法在ES5严格模式和ES6钟已被废除）
+ 十六进制：前缀`0x`或`0X`
+ 二进制：前缀`0b`或`0B`

------

## 4. 特殊的数值

### 4.1 正0和负0

几乎所有场合正0和负0都会被视为正常的0且等价，唯一的区别是+0和-0作为分母返回的值不同，因为除以正零得到`+Infinity`，除以负零得到`-Infinity`